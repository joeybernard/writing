Image Processing on Linux


We have looked at lots of scientific packages over the years that generate very nice graphical representations of your data and work. We have not gone in the other direction very much, however. This month, we will look at a very popular image processing package called ImageJ. Specifically, we will look at Fiji, an instance of ImageJ bundled with a set of plugins that are useful for scientific image processing. The name Fiji is a recursive acronym, much like GNU. In this case, it stands for "Fiji Is Just ImageJ". ImageJ is a very useful tool in analyzing images in scientific research. For example, you may be looking at classifying tree types in a landscape from aerial photography. ImageJ can be used to do that type categorization. It is built with a plugin architecture, and a very extensive collection of plugins available to increase the available functionality.

The first step is to install ImageJ, or Fiji. Most distributions will have a package available for ImageJ. If you wish, you can install it this way and then install the individual plugins that you need for your research. The other option is to install Fiji and get the most commonly used plugins at the same time. Unfortunately, most Linux distributions will not have a package available within their package repositories for Fiji. Luckily, an easy installation file is available from the main web site. It is just a simple zip file, containing a directory with all of the files required to run Fiji. When you first start it up, you only get a small toolbar with a list of menu items. [fiji1.png] If you don't already have some images that you can use as you are learning about how to use ImageJ, The Fiji installation includes a number of sample images that you can use. For example, clicking on the menu item "File->Open Samples" will give you a dropdown of sample images. [fiji2.png] These samples cover many of the potential tasks that you might be interested in working on. If you installed Fiji, rather than ImageJ alone, you will have a large set of plugins already installed. The first one of note is the autoupdater plugin. This plugin checks the internet for updates to ImageJ, as well as the installed plugins, each time that ImageJ is started. All of the installed plugins are available under the menu item 'Plugins'. Once you get a number of plugins installed, this list can become a bit wieldly, so you may want to be judicious in your plugin selection. If you want to manually trigger the updates, you can click on the menu item 'Help->Update Fiji' to force the check and get a list of those updates that are available. [fiji3.png]

Now, what kind of work can you do with Fiji/ImageJ?  One example is that you can do counts of objects within an image. You can load a sample by clicking on the menu item 'File->Open Samples->Embryos' to load the example. [fiji4.png] The first step is to set a scale to the image so that you can tell ImageJ how to identify objects. First, select the line button on the toolbar and draw a line over the length of the scale legend on the image. You can then select the menu item 'Analyze->Set Scale...', and it will set the number of pixels that the scale legend occupies. [fiji5.png] You can then set the known distance to be 100 and the units to be 'um'. The next step is to simplify the information within the image. Clicking on the menu item 'Image->Type->8-bit' to reduce the information to an 8-bit gray-scale image. To isolate the individual objects, you can click on the menu item 'Process->Binary->Make Binary' to automatically threshold the image. [fiji6.png] Before you can count the objects within the image, you need to remove artifacts like the scale legend. You can do this by using the rectangular selection tool to select it and then click on the menu item 'Edit->Clear'. Now you can analyze the image and see what objects are there. Making sure that there are no areas selected in the image, you can click on the menu item 'Analyze->Analyze Particles...' to pop up a window where you can select the minimum size, what results to display, and what to show in the final image. [fiji7.png] An overall look at what was discovered is the summary results window. [fiji8.png] There is also a detailed results window for each individual particle.

Once you have an analysis worked out for a given image type, you very often need to apply the very same analysis to a series of images.. This series may number into the thousands, so it is not something you want to repeat manually for each image. In these cases, you can collect the required steps together into a macro so that they can be reapplied multiple times. Clicking on the menu item 'Plugins->Macros->Record...' will pop up a new window where all of your subsequent commands will be recorded. Once all of the steps are done, you can save them as a macro file and rerun them on other images by clicking on the menu item 'Plugins->Macros->Run...'. If you have a very specific set of steps for your workflow, you can simply open the macro file and edit it by hand, as it is a simple text file. There is actually a complete macro language available to you to more fully control that process that is being applied to your images. If you have a really large set of images that need to be processed, however, this might still be too tedious for your workflow. In that case, you can click on the menu item 'Process->Batch->Macro...' to pop up a new window where you can setup your batch processing workflow. [fiji9.png] From this window, you can select which macro file to apply, the source directory where the input images are located and the output directory where the output images should be written to. You can also set the output file format, and filter the list of images being used as input based on what the filename contains. Once everything is done, you start the batch run by clicking the 'Process' button at the bottom of the window. If this is a workflow that will be repeated over time, you can save the batch process to a text file by clicking the 'Save...' button at the bottom of the window. You can then reload the same workflow by clicking on the 'Open...' button, also at the bottom of the window. All of this functionality allows you to automate the most tedious parts of your research so that you can focus on the actual science.

Considering that there are over 500 plugins and over 300 macros available from the main ImageJ website alone, it is an understatement that we have only been able to touch the most basic of topics in this short article. Luckily, there are a number of domain-specific tutorials available, along with the very good documentation for the core of ImageJ from the main project web site. If you think that this is a tool that could be of use to your research, there is a wealth of information to guide you in your particular area of research.


LINKS
https://imagej.net/Fiji  -  The main site for Fiji


IMAGES
fiji1.png  -  You get a very minimal interface when you first start Fiji up.
fiji2.png  -  There are several sample images available that you can use as you learn how to use ImageJ.
fiji3.png  -  You can force a manual check of what updates are available.
fiji4.png  -  With ImageJ you can count objects within an image.
fiji5.png  -  For many image analysis tasks, you need to set a scale to the image.
fiji6.png  -  There are automatic tools to do tasks like thresholding.
fiji7.png  -  You can generate a reduced image with identified particles.
fiji8.png  -  One of the output results includes a summary list of the particles identified.
fiji9.png  -  You can run a macro on a batch of input image files with a single command.
