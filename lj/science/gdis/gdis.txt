Displaying Atoms with GTK


This month, we will be diving back into software that is useful to chemists. Specifically, we will be looking at GDIS (GTK Display Interface for Structures). With GDIS, you can create and display various atomic and molecular structures. Since GDIS is a fairly popular program for chemistry research, you should be able to find it in the package repository for most distributions. For Debian-based distributions, you can install GDIS with the following command
   sudo apt-get install gdis
When you start it up, you get a blank workspace to start your structure. [gdis1.png]

The initial workspace is properly blank, in that you don't have any underlying information to build upon. The first step is to create a new model to contain your work. Once you have a model, you will need to start adding to it. When you click the menu item "Tools->Building->Editing...", you get a new pop up window with lots of options for building your structure. [gdis2.png] With this window, you can start to add atoms and the bonds between them. You could also click on the model entry in the pane on the left-hand side of the screen. [gdis3.png] This section also allows you to add atoms and bonds to your structure. Let's pick a simple molecule to see what kinds of work we can do with GDIS. In this article, we will play with a single water molecule. Using the editing pane on the left-hand side, you can add specific elements by entering the element symbol into the "Label" portion and then clicking on add atom. You can then click on the canvas and add any number of the given atoms, in this case "H" and "O" atoms. The next step is to create the bonds between each of the atoms for our water molecule. You will need to click on the "Add bonds" button in the editing pane, and then click and drag between the atoms that have a bond between them. [gdis4.png] The default display is to show stick and ball diagrams, using solid rendering of the model. If you click on the "Model : Display" option in the left-hand pane, you can change these viewing settings. For example, you can click on the "Wire frame" option to switch to that from solid rendering. Also, you could click on "CPK" to get a display that is more reminiscent of electron cloud visualizations. If you need more fine grained control over the display, you will need to click on the menu item "View->Display properties...". [gdis5.png] With this new window, you can change sizes and colours of all of the relevant items in your model. You can also change other details, such as the camera and lighting positions and directions. If you want to play with more complex models, without having to create them from scratch, you can start with one of the pre-built models included with the installation of GDIS. On my Ubuntu box, these models are under "/usr/share/gdis/models". You can load them by clicking on the menu item "File->Open".

But, what else can you do with GDIS? You can do some basic measurements of the model to get some ideas of the physical structure. For example, with the loaded water molecule, you can find the bond measurements between the oxygen and hydrogen atoms. Clicking on either the measurement icon in the toolbar, or clicking on the menu item "Tools->Analysis->Measurements...", will pop up a new window. [gdis6.png] Within this window, you can click on the "Search" tab to get GDIS to query your model and pull out relevant measurements. The default measurement type is "Bonds". When you click on the search button, you will get all of the bond measurements for your system in the bottom pane. You can also search for "Distance", "Intermolecular", "Bond Angles" and "Angles" types of measures for your model.

If you are doing molecular dynamics (MD) calculations on your models, GDIS can help you create the relevant input files and execute a number of different MD programs directly from GDIS. This includes very popular programs like GAMESS and SIESTA. As an example, clicking on the menu item "Tools->Computation->GAMESS..." will pop up a new window. [gdis7.png] This will require you to go out and install one or more of these programs, as they tend to not be in the package repositories for most distributions. For example, you would need to go to "https://www.msg.chem.iastate.edu/gamess/download.html" to accept the license for GAMESS and get access to the download files. These types of programs are used when you want to calculate detailed properties for molecules, such as vibration states or energy level transitions.

While you can get GDIS to run other programs to get detailed computations done, what about getting output that is useful for sharing those results? GDIS is able to use POV-Ray to render high quality three dimensional images of your model. You will need to have POV-Ray installed first, so that GDIS can find it and use it to do the render. One thing to be aware of is that POV-Ray needs to create intermediate files, as well as the final image file. This means that it will fail if you are using one of the example files from the "/usr/share/gdis/models" directory. You will need to copy the files of interest to your home directory where you will have write permissions. Running the process on the example butane molecule gives the following results. [gdis8.png] If you want to have something a bit more eye catching, GDIS can help you create animations of your model, too. Clicking on the menu item "View->Recording Mode" tells GDIS that you want to record activity within the program. From this point forward, frames are being created as you are moving items around the canvas and interacting with the model. Then, you can click on the menu item "Tools->Visualization->Animation..." to pop up a new window where you can set options. [gdis9.png] This should let you save off the animation as either an MPEG movie or an animated GIF.

When you are done and want to share your model with other researchers, you can import and export from a large number of possible file formats. These include the more common ones, such as GAUSSIAN and GAMESS, as well as a GDIS specific file format. Hopefully, this short introduction gets you started with some of the tools that GDIS provides for chemical model creation.



IMAGES
gdis1.png  -  When you start up GDIS, you get a blank project to start your work.
gdis2.png  -  The editing tool pane provides lots of options to build up your structures.
gdis3.png  -  You can access several tools from the pane on the left-hand side of the window.
gdis4.png  -  Building a water molecule from scratch.
gdis5.png  -  You can edit most of the display properties to get the rendering of your model exactly the way you want it to look.
gdis6.png  -  You can get GDIS to make physical measurements of your model.
gdis7.png  -  GDIS can help you create input files and run them through various MD programs.
gdis8.png  -  You can get GDIS to use POV-Ray to generate high resolution 3D images.
gdis9.png  -  The animation settings window lets you set the parameters for movies within GDIS.



URLS
http://gdis.seul.org/  -  GDIS main web site
https://github.com/arohl/gdis  -  GDIS github site
