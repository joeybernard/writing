Antennas in Linux


This month, we will look at a piece of software that I have actually used recently in my own work. My new day job involves studying the ionosphere using an instrument called an ionosonde. This device is basically a giant radio transmitter that bounces radio waves off of the ionosphere to see its structure and composition. Obviously, an important part of this is knowing the radiation pattern of the various transmitters and receivers. There are several methods of modeling the electromagnetic fields around conductors, but we will be looking at one called NEC2 (Numerical Electromagnetics Code). It was originally developed in FORTRAN at the Lawrence Livermore National Laboratory in the 1970's. Since then, it has been reimplemented several times in various languages. Specifically, we will look at xnec2c. This package implements NEC2 in C, and also provides a GTK frontend for interacting with the core engine. Xnec2c should be available in most Linux distributions. For example, in Debian-based distributions, you can install it with the command
   sudo apt-get install xnec2c
Once it is installed, you can start it with xnec2c. [xnec2c1.png] The default display doesn't show anything until you actually start using it.

Xnec2c's history still affects how it behaves to the present day. This is most clear when you look at the format of the input file. The basic structure is laid out around the idea of a punch card, where each "command" to xnec2c is given by a command card. This is a definite holdover from its FORTRAN roots. Luckily, the GTK frontend to xnec2c provides a reasonably functional way of building up these input files. You should have several example files available with your installation of xnec2c. In my Ubuntu distribution, these files are located in /usr/share/doc/xnec2c/examples. These input files have the filename ending ".nec". You can select one of these as a starting off point in order to play with xnec2c, and then go on and make the required alterations necessary for your own project. [xnec2c2.png] The central window pane gives you a geometric view of the actual antenna structure in three dimensions. You can click and drag the diagram to rotate the view and see it from all angles. There are two larger buttons at the top of the window, named "Currents" and "Charges". Selecting them will show alternately either the distribution of currents or the distribution of charges caused by the driving current.

Once you are sure that the physical layout looks correct, you can start to see what the electromagnetic behavior of the system looks like. On the menu bar at the top, there is an entry named "View". Clicking on "Radiation Pattern" pops up a new window where you can view what the electromagnetic radiation pattern looks like. You have a few different options available. The first, "Gain Pattern", gives you what most people will probably think of as the radiation pattern. [xnec2c3.png] Again, you can click and drag the image to get a better view of the pattern from various angles. In the same window, there is a second display option. Assuming that your input file has the appropriate entries, you can click on the "E/H Fields" button and see a view of the electric and/or magnetic fields for your configuration. [xnec2c4.png] At the top of the window, there are several options available. For example, you can change the frequency of the driving current. This way, you can see how your system behaves at different frequencies.

The second major display that you have available to you shows you how your antenna design behaves over a series of driving frequencies. Clicking the menu item "View->Frequency Plots" pops up a new window. [xnec2c5.png] The first button shows you how the gain changes over a given frequency sweep. Clicking on each subsequent button adds a new graph to the same window. For example, you can click on the "VSWR" button to see how the Voltage Standing Wave Ratio (VSWR) changes over frequency. [xnec2c6.png] You will probably need to resize the window if you want to view more than a couple of graphs simultaneously. As with the "E/H Fields" plot from earlier, whether these plots behave as you would expect depends on the input file being used.

The example files give you a great place to start from, but they are not likely to match your situation exactly. In these cases, you will want to edit the input files to configure the system exactly as you need it to be. While you can simply open the input file in any text editor, xnec2c includes an edit function built in. Clicking on the menu item "File->Edit" pops open a new window where you can see all of the input cards. [xnec2c7.png] You can change the values for already existent cards, but the best feature of this editor is that you can add new cards with the click of a button. If you are new to NEC2 and its input format, you may not necessarily remember the codes and formats for the various types of input cards. The editor window helps with this part of your work. There are even buttons, like mirror and scale, that help in the design phase by taking advantage of symmetries that you may have in your antenna.

In each of these displays, you have a couple of different options when it comes to saving your results. The simplest is clicking on the menu item "File->Save As". This option lets you save the resulting image as a PNG file. If you click on the menu item "File->Save As gnuplot", the actual data gets exported into a file. The format is an appropriate one for the type of data that you might want to feed into gnuplot. This way, you can tailor the resulting graphical display for your particular situation. This is because the results generated by xnec2c are not directly comparable with those from other implementations of NEC2. Its focus is more along the functionality of being interactive. If you want more traditional output, you can use xnec2c to view your antenna configuration, then use nec2c to generate your final results.




IMAGES
xnec2c1.png  -  Launching xnec2c gives you a pretty boring starting point.
xnec2c2.png  -  Loading an input file, you begin with a geometric view of the relevant antenna wires, other conductors and any ground planes.
xnec2c3.png  -  You can easily model the radiation pattern from an antenna system.
xnec2c4.png  -  If your input file has the appropriate entries, you can see a display of the electric and magnetic fields.
xnec2c5.png  -  You can get several detailed plots of the electrical behavior of your antenna design.
xnec2c6.png  -  You can see multiple plots of the electrical behavior stacked on top of each other, in order to get a better overall view of your antenna configuration.
xnec2c7.png  -  You can use the built in editor to customize the input file to your personal specifications.
